<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>inMentando¬Æ - El Principito</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        /* OPTIMIZACI√ìN 1: Scroll permitido y altura flexible para monitores de 15" */
        body { 
            font-family: 'Nunito', sans-serif; 
            background: linear-gradient(180deg, #1e3a8a 0%, #0f172a 100%); 
            color: white; 
            min-height: 100vh; 
            overflow-x: hidden;
            cursor: pointer; 
        }
        .comic-font { font-family: 'Comic Neue', cursive; }
        
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-15px); } }
        .animate-float { animation: float 4s ease-in-out infinite; }
        
        /* Contenedor optimizado para escala de monitor 15" */
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .btn-kid {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1e40af;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            border: 3px solid white;
            cursor: pointer;
            font-size: 18px;
            font-family: 'Comic Neue', cursive;
            box-shadow: 0 4px 0 #d97706;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-kid:hover { transform: translateY(-2px); box-shadow: 0 6px 0 #d97706; }
        .btn-kid:active { transform: translateY(1px); box-shadow: 0 2px 0 #d97706; }
        
        .btn-option {
            background: white;
            color: #1e40af;
            border: 2px solid #60a5fa;
            border-radius: 15px;
            padding: 12px;
            font-size: 16px;
            text-align: left;
            transition: all 0.3s;
            cursor: pointer;
            font-weight: 600;
            margin: 8px 0;
            width: 100%;
            box-shadow: 0 3px 0 #93c5fd;
        }
        
        .btn-option:hover { background: #dbeafe; transform: translateX(5px); }
        .btn-option.correct { background: #bbf7d0 !important; border-color: #22c55e !important; color: #166534 !important; }
        .btn-option.wrong { background: #fecaca !important; border-color: #ef4444 !important; color: #991b1b !important; }
        
        .character-img {
            width: 180px;
            height: 180px;
            object-fit: cover;
            border-radius: 20px;
            border: 4px solid white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
        }
        
        .speech-bubble {
            background: white;
            border-radius: 25px;
            padding: 15px 25px;
            position: relative;
            border: 4px solid #fbbf24;
            color: #1e40af;
            font-size: 18px;
            line-height: 1.4;
            box-shadow: 0 5px 0 rgba(0,0,0,0.1);
        }
        
        /* OPTIMIZACI√ìN 2: Nombre en el diploma con contraste claro */
        .name-input {
            padding: 10px 15px;
            font-size: 20px;
            border: 3px solid #fbbf24;
            border-radius: 12px;
            text-align: center;
            font-family: 'Comic Neue', cursive;
            width: 100%;
            max-width: 350px;
            margin: 15px auto;
            display: block;
            background: #ffffff; /* Fondo blanco */
            color: #1a1a1a;    /* Letra negra */
        }
        
        .inmentando-trademark {
            font-family: 'Comic Neue', cursive;
            font-weight: bold;
            color: #7c3aed;
        }

        /* OPTIMIZACI√ìN 3: Impresi√≥n en 1 sola hoja */
        @media print {
            @page { size: A4; margin: 0; }
            body * { visibility: hidden; }
            #diplomaContent, #diplomaContent * { visibility: visible; }
            #diplomaContent {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                display: flex !important;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background: white !important;
                padding: 20px !important;
                transform: scale(0.95);
            }
            .no-print { display: none !important; }
        }

        .hidden { display: none; }
    </style>
</head>
<body onclick="activateAudio()">
    <div id="clickMessage" class="fixed bottom-5 left-0 right-0 text-center bg-black/80 p-3 mx-6 rounded-xl border-2 border-yellow-400 z-[100] animate-pulse">
        <p class="text-yellow-300 font-bold"><i class="fas fa-hand-point-up mr-2"></i>¬°Haz clic para activar el sonido inMentando¬Æ!</p>
    </div>

    <div id="startScreen" class="fixed inset-0 flex flex-col items-center justify-center z-50 bg-gradient-to-b from-blue-600 to-indigo-900 p-6">
        <div class="text-center game-container">
            <div class="text-7xl mb-6 animate-float">üëë</div>
            <h1 class="text-5xl md:text-7xl font-bold mb-4 comic-font text-yellow-300" style="text-shadow: 3px 3px 0 #1e40af;">
                El Principito
            </h1>
            <p class="text-2xl text-blue-100 mb-8 font-bold">Experiencia Pedag√≥gica inMentando¬Æ</p>
            
            <div class="bg-white/10 backdrop-blur-md rounded-3xl p-6 border-2 border-white/20 mb-8 max-w-xl mx-auto">
                <p class="text-xl text-white leading-relaxed">
                    Viaja por 10 cap√≠tulos m√°gicos, escucha las historias y demuestra tu sabidur√≠a espacial.
                </p>
            </div>
            
            <button id="startButton" class="btn-kid text-2xl px-12 py-5 mb-6">
                <i class="fas fa-rocket mr-3"></i>¬°COMENZAR!
            </button>
        </div>
    </div>

    <div id="gameScreen" class="hidden min-h-screen flex flex-col lg:flex-row">
        <div class="lg:w-2/3 p-4 flex flex-col justify-between bg-blue-500/20">
            <div class="flex justify-between items-center bg-white/10 p-4 rounded-2xl mb-4">
                <div class="flex items-center gap-3">
                    <span class="text-3xl">üëë</span>
                    <h2 class="text-xl font-bold comic-font">inMentando¬Æ</h2>
                </div>
                <div class="bg-yellow-400 text-blue-900 px-4 py-1 rounded-full font-bold">
                    CAP√çTULO <span id="currentChapter">1</span>/10
                </div>
            </div>

            <div class="flex flex-col items-center gap-6 my-auto">
                <div class="text-center">
                    <img id="characterImage" src="" class="character-img mx-auto mb-3">
                    <h3 id="characterName" class="text-xl font-bold text-yellow-300 comic-font"></h3>
                </div>
                
                <div class="speech-bubble w-full max-w-xl">
                    <p id="storyText" class="text-gray-800 font-semibold"></p>
                </div>

                <div class="flex gap-4">
                    <button id="playVoice" class="btn-kid bg-green-500"><i class="fas fa-play"></i> ESCUCHAR</button>
                    <button id="repeatVoice" class="btn-kid bg-blue-500"><i class="fas fa-redo"></i> REPETIR</button>
                </div>
                <div id="voiceIndicator" class="hidden text-green-400 animate-pulse font-bold">
                    <i class="fas fa-volume-up"></i> El Principito est√° hablando...
                </div>
            </div>

            <div id="chaptersContainer" class="flex gap-2 overflow-x-auto p-2 mt-4"></div>
        </div>

        <div class="lg:w-1/3 p-6 bg-purple-900/40 backdrop-blur-sm border-l-2 border-white/10 flex flex-col">
            <div class="bg-white rounded-3xl p-5 shadow-xl mb-6">
                <h4 class="text-purple-800 font-bold text-lg mb-2 comic-font">PREGUNTA:</h4>
                <p id="questionText" class="text-gray-900 font-bold text-xl mb-4"></p>
                <div id="optionsContainer" class="space-y-2"></div>
                
                <div id="feedbackArea" class="hidden mt-4 p-3 rounded-xl text-center animate-bounce">
                    <span id="feedbackEmoji" class="text-3xl"></span>
                    <p id="feedbackText" class="font-bold text-gray-800"></p>
                </div>
            </div>

            <div class="bg-gradient-to-r from-yellow-400 to-orange-500 rounded-3xl p-5 text-center shadow-lg mt-auto">
                <h4 class="text-blue-900 font-bold comic-font">RECOMPENSAS</h4>
                <div id="starsArea" class="text-2xl my-2">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <div class="text-3xl font-bold text-white"><span id="score">0</span> pts</div>
            </div>
        </div>
    </div>

    <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
    <audio id="pageSound" src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3"></audio>

    <script>
        /* LOS DATOS SE MANTIENEN ID√âNTICOS AL ORIGINAL */
        const chapters = [
            { id: 1, title: "El Dibujo", character: "La Boa", characterDesc: "Misterio", characterImage: "https://i.imgur.com/mWcQ8Oy.jpeg", story: "Cuando ten√≠a 6 a√±os, dibuj√© una serpiente que se comi√≥ un elefante. Pero los grandes solo ve√≠an un sombrero.", voiceText: "Cuando ten√≠a seis a√±os, dibuj√© una serpiente boa que se comi√≥ un elefante entero. Pero los adultos solo ve√≠an un sombrero aburrido. ¬øT√∫ puedes ver con tu imaginaci√≥n al elefante dentro de la serpiente?", question: "¬øPor qu√© los grandes dec√≠an que era un sombrero?", options: ["Porque no usaban su imaginaci√≥n", "Porque era de color aburrido", "Porque los sombreros son divertidos"], correct: 0, feedback: "¬°Excelente! La imaginaci√≥n es la clave.", feedbackEmoji: "üé®", color: "#3B82F6" },
            { id: 2, title: "El Pedido", character: "El Principito", characterDesc: "Curioso", characterImage: "https://i.imgur.com/AsZ5lxV.jpeg", story: "¬°Hola! Soy el Principito. Vivo en un planeta peque√±o y necesito una oveja.", voiceText: "¬°Hola! Soy el Principito. Vivo en un planeta peque√±o y necesito una oveja. La ped√≠ muchas veces al piloto, hasta que por fin me dibuj√≥ una oveja dentro de una caja. Cuando algo es importante, no hay que rendirse.", question: "¬øQu√© nos ense√±a que pidiera la oveja tantas veces?", options: ["No hay que rendirse", "Le gustaba molestar", "Las ovejas son dif√≠ciles"], correct: 0, feedback: "¬°Muy bien! La persistencia es importante.", feedbackEmoji: "üêë", color: "#10B981" },
            { id: 3, title: "La Caja", character: "La Caja", characterDesc: "M√°gica", characterImage: "https://i.imgur.com/SeTJoaa.jpeg", story: "Me dibujaron una caja con agujeros. ¬°Adentro est√° la oveja perfecta!", voiceText: "El piloto me dibuj√≥ una caja con tres agujeros. Me dijo: ¬°Adentro est√° la oveja perfecta que t√∫ imaginas! La imaginaci√≥n es m√°gica.", question: "¬øQu√© hab√≠a dentro de la caja realmente?", options: ["La oveja imaginaria perfecta", "Un juguete", "Nada"], correct: 0, feedback: "¬°S√≠! Vemos con el coraz√≥n.", feedbackEmoji: "üì¶", color: "#8B5CF6" },
            { id: 4, title: "El Astr√≥nomo", character: "El Sabio", characterDesc: "Inteligente", characterImage: "https://i.imgur.com/ReoYknX.jpeg", story: "Un astr√≥nomo descubri√≥ mi planeta, pero nadie le crey√≥ por su ropa.", voiceText: "Un astr√≥nomo descubri√≥ mi planeta pero nadie le crey√≥ por su ropa. A√±os despu√©s se puso traje ¬°y todos le creyeron! Lo importante es lo que sabemos, no la ropa.", question: "¬øEst√° bien juzgar a alguien por su ropa?", options: ["No, importa lo que sabe", "S√≠, hay que usar traje", "Solo a veces"], correct: 0, feedback: "¬°Exacto! El valor est√° en el interior.", feedbackEmoji: "üëî", color: "#EC4899" },
            { id: 5, title: "Los Baobabs", character: "Los √Årboles", characterDesc: "Gigantes", characterImage: "https://i.imgur.com/8dZC02i.jpeg", story: "¬°Cuidado con los baobabs! Si no los saco cada ma√±ana, rompen mi planeta.", voiceText: "Cuidado con los baobabs. Si no los saco cada ma√±ana de ra√≠z, crecen y rompen mi hogar. Los problemas peque√±os hay que solucionarlos pronto.", question: "¬øQu√© pasa si no sacamos los problemas a tiempo?", options: ["Se hacen gigantes y nos da√±an", "Se hacen flores", "No pasa nada"], correct: 0, feedback: "¬°Bien! Hay que ocuparse pronto de lo importante.", feedbackEmoji: "üå≥", color: "#059669" },
            { id: 6, title: "Puesta de Sol", character: "La Paz", characterDesc: "Tranquilidad", characterImage: "https://i.imgur.com/OHaJadm.jpeg", story: "Cuando estoy triste, veo puestas de sol para sentirme mejor.", voiceText: "Cuando me siento triste, me encanta ver puestas de sol. Las cosas bellas nos ayudan a sentirnos mejor.", question: "¬øQu√© buscaba el Principito al ver el sol?", options: ["Paz para su coraz√≥n", "Enojarse m√°s", "Quedarse a oscuras"], correct: 0, feedback: "¬°Hermoso! La belleza nos sana.", feedbackEmoji: "üåÖ", color: "#F59E0B" },
            { id: 7, title: "Las Espinas", character: "La Defensa", characterDesc: "Protecci√≥n", characterImage: "https://i.imgur.com/QCPOLal.jpeg", story: "Las flores tienen espinas para defenderse, aunque sean fr√°giles.", voiceText: "Las flores son fr√°giles pero tienen espinas para defenderse. Todos necesitamos protegernos.", question: "¬øPara qu√© sirven las espinas?", options: ["Para protegerse", "Para pelear", "Para pinchar ni√±os"], correct: 0, feedback: "¬°Correcto! Todos tenemos defensas.", feedbackEmoji: "üåπ", color: "#DC2626" },
            { id: 8, title: "La Rosa", character: "La Amiga", characterDesc: "√önica", characterImage: "https://i.imgur.com/a6Qj0So.jpeg", story: "Mi rosa es dif√≠cil, pero aprend√≠ que lo importante es c√≥mo la cuido.", voiceText: "Mi rosa es especial. A veces se queja, pero descubr√≠ que detr√°s de eso me quiere mucho. Aprend√≠ a cuidarla.", question: "¬øQu√© descubri√≥ el Principito sobre su rosa?", options: ["Que ella lo quer√≠a mucho", "Que era mejor dejarla", "Que no necesitaba agua"], correct: 0, feedback: "¬°S√≠! El amor es cuidar.", feedbackEmoji: "üíñ", color: "#F43F5E" },
            { id: 9, title: "El Viaje", character: "P√°jaros", characterDesc: "Libertad", characterImage: "https://i.imgur.com/Z4RngOW.jpeg", story: "Me voy de viaje con los p√°jaros para aprender cosas nuevas.", voiceText: "Me voy de viaje con los p√°jaros para aprender. Conocer lugares nuevos nos hace m√°s sabios.", question: "¬øEs bueno conocer otros mundos?", options: ["S√≠, nos hace m√°s sabios", "No, da miedo", "Solo si es en avi√≥n"], correct: 0, feedback: "¬°Viajar abre la mente!", feedbackEmoji: "üê¶", color: "#6366F1" },
            { id: 10, title: "El Rey", character: "El Jefe", characterDesc: "Bondad", characterImage: "https://i.imgur.com/xVsRhTP.jpeg", story: "Un buen rey solo pide cosas que los dem√°s PUEDAN hacer.", voiceText: "Soy el rey, pero solo pido cosas razonables. Un buen l√≠der manda con bondad y sentido com√∫n.", question: "¬øC√≥mo debe ser un buen l√≠der seg√∫n el Rey?", options: ["Bondadoso y razonable", "Enoj√≥n y dif√≠cil", "Que no haga nada"], correct: 0, feedback: "¬°Perfecto! As√≠ es la verdadera autoridad.", feedbackEmoji: "üëë", color: "#A855F7" }
        ];

        let currentIdx = 0;
        let score = 0;
        let userInteracted = false;

        function init() {
            createChapterNav();
            loadChapter(0);
            document.getElementById('startButton').onclick = () => {
                document.getElementById('startScreen').classList.add('hidden');
                document.getElementById('gameScreen').classList.remove('hidden');
            };
            document.getElementById('playVoice').onclick = () => speak();
            document.getElementById('repeatVoice').onclick = () => speak();
        }

        function createChapterNav() {
            const container = document.getElementById('chaptersContainer');
            chapters.forEach((_, i) => {
                const btn = document.createElement('button');
                btn.className = "px-4 py-2 bg-white/20 rounded-lg font-bold hover:bg-white/40 transition";
                btn.innerText = i + 1;
                btn.onclick = () => loadChapter(i);
                container.appendChild(btn);
            });
        }

        function loadChapter(i) {
            currentIdx = i;
            const c = chapters[i];
            document.getElementById('currentChapter').innerText = c.id;
            document.getElementById('characterImage').src = c.characterImage;
            document.getElementById('characterName').innerText = c.character;
            document.getElementById('storyText').innerText = c.story;
            document.getElementById('questionText').innerText = c.question;
            
            const opts = document.getElementById('optionsContainer');
            opts.innerHTML = '';
            c.options.forEach((o, index) => {
                const b = document.createElement('button');
                b.className = 'btn-option';
                b.innerText = o;
                b.onclick = () => check(index, c.correct);
                opts.appendChild(b);
            });
            document.getElementById('feedbackArea').classList.add('hidden');
        }

        function check(sel, corr) {
            const buttons = document.querySelectorAll('.btn-option');
            buttons.forEach(b => b.style.pointerEvents = 'none');
            
            if(sel === corr) {
                buttons[sel].classList.add('correct');
                score += 10;
                document.getElementById('score').innerText = score;
                document.getElementById('correctSound').play();
                showFeedback(true);
            } else {
                buttons[sel].classList.add('wrong');
                buttons[corr].classList.add('correct');
                document.getElementById('wrongSound').play();
                showFeedback(false);
            }

            setTimeout(() => {
                if(currentIdx < 9) loadChapter(currentIdx + 1);
                else finish();
            }, 2500);
        }

        function showFeedback(isCorrect) {
            const area = document.getElementById('feedbackArea');
            area.classList.remove('hidden');
            document.getElementById('feedbackEmoji').innerText = chapters[currentIdx].feedbackEmoji;
            document.getElementById('feedbackText').innerText = chapters[currentIdx].feedback;
        }

        function speak() {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(chapters[currentIdx].voiceText);
            msg.lang = 'es-ES';
            msg.onstart = () => document.getElementById('voiceIndicator').classList.remove('hidden');
            msg.onend = () => document.getElementById('voiceIndicator').classList.add('hidden');
            window.speechSynthesis.speak(msg);
        }

        function finish() {
            const name = prompt("¬°Genial! Escribe tu nombre para tu Diploma de inMentando¬Æ:") || "Explorador";
            document.body.innerHTML = `
                <div id="diplomaContent" class="flex flex-col items-center justify-center min-h-screen bg-white p-10 text-center text-gray-900">
                    <h1 class="text-4xl font-bold text-blue-900 mb-4 comic-font">DIPLOMA DE EXCELENCIA</h1>
                    <p class="text-xl mb-6">inMentando¬Æ certifica que:</p>
                    <h2 class="text-5xl font-bold text-purple-700 mb-8 comic-font">${name}</h2>
                    <p class="text-2xl mb-10">Complet√≥ con √©xito el viaje de "El Principito" con ${score} puntos.</p>
                    <div class="text-6xl mb-10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    <p class="italic text-gray-500">"Lo esencial es invisible a los ojos"</p>
                    <div class="mt-10 no-print">
                        <button onclick="window.print()" class="btn-kid bg-blue-600 mr-4">IMPRIMIR EN 1 HOJA</button>
                        <button onclick="location.reload()" class="btn-kid bg-gray-600">VOLVER A JUGAR</button>
                    </div>
                </div>
            `;
        }

        function activateAudio() { 
            userInteracted = true; 
            document.getElementById('clickMessage').classList.add('hidden'); 
        }

        window.onload = init;
    </script>
</body>
</html>
